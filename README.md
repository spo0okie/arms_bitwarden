# Inventory-BW-sync
Скрипт синхронизации коллекций [Bitwarden](https://bitwarden.com/) (Вообще тестировалось только с [Vaultwarden](https://vaultwarden.net/)) со структурой сервисов Инвентаризации  
  
## Синхронизация Инвентаризация -> BW(VW)
  * Повторяет в VW структуру коллекций на повторяющую структуру сервисов из [БД Инвентариацзии](https://github.com/spo0okie/arms_inventory)
  * Выдает на коллекцию права команде сопровождения соответствующего сервиса (ответственный + поддержка)
    * той части команды которая имеет учетки в BW(VW)
    * если состав команды изменяются - требует ручного подтверждения изменения прав на коллекцию (новые коллекцие создает без запроса т.к. они изначально пусты)
    * если никого из состава команды сервиса нет в BW(VW) - коллекция не создается (технически не возможно)

## Требования
  * [Vaultwarden](https://github.com/dani-garcia/vaultwarden)
  * [Bitwarden CLI](https://bitwarden.com/help/cli/)
    * Для работы с self-hosted сервером с непубличным сертификатом нужен не бинарник а установленный через NPM
   
## Инструкция
  * ```bash
    mkdir -p /opt/inventory-bw-sync
    cd /opt/inventory-bw-sync
    git clone https://github.com/spo0okie/inventory-bw-sync.git .
    mv config.priv.sample.php config.priv.php
    ```
  * настраиваем конфиг **config.priv.php**
    * пользователь для авторизации в Инвентаризации должен иметь права на чтение списка сервисов
    * пользователь для авторизации в BW(VW) должен иметь права на запись в корневой коллекции
      * Хэшированный пароль можно посмотреть через Chrome Developer Tools (F12) -> network -> запрос метода **token** -> поле **password**
  * php ./sync.php
